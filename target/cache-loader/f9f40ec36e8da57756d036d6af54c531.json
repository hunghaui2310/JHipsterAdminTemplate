{"remainingRequest":"/home/hungnn/Documents/angular/dashboard/node_modules/thread-loader/dist/cjs.js??ref--10-2!/home/hungnn/Documents/angular/dashboard/node_modules/ts-loader/index.js??ref--10-3!/home/hungnn/Documents/angular/dashboard/node_modules/angular-router-loader/src/index.js!/home/hungnn/Documents/angular/dashboard/node_modules/tslint-loader/index.js!/home/hungnn/Documents/angular/dashboard/src/main/webapp/app/ngx-admin/pages/e-commerce/country-orders/map/country-orders-map.component.ts","dependencies":[{"path":"/home/hungnn/Documents/angular/dashboard/src/main/webapp/app/ngx-admin/pages/e-commerce/country-orders/map/country-orders-map.component.ts","mtime":1593660862956},{"path":"/home/hungnn/Documents/angular/dashboard/node_modules/angular2-template-loader/index.js","mtime":1486570058000},{"path":"/home/hungnn/Documents/angular/dashboard/node_modules/cache-loader/dist/cjs.js","mtime":1593666990470},{"path":"/home/hungnn/Documents/angular/dashboard/node_modules/thread-loader/dist/cjs.js","mtime":1593666988914},{"path":"/home/hungnn/Documents/angular/dashboard/node_modules/ts-loader/index.js","mtime":1519365772000},{"path":"/home/hungnn/Documents/angular/dashboard/node_modules/angular-router-loader/src/index.js","mtime":1512749902000},{"path":"/home/hungnn/Documents/angular/dashboard/node_modules/tslint-loader/index.js","mtime":1519899048000}],"contextDependencies":[],"result":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar core_1 = require(\"@angular/core\");\nvar L = require(\"leaflet\");\nvar country_orders_map_service_1 = require(\"./country-orders-map.service\");\nvar theme_1 = require(\"@nebular/theme\");\nvar rxjs_1 = require(\"rxjs\");\nvar operators_1 = require(\"rxjs/operators\");\nvar CountryOrdersMapComponent = /** @class */ (function () {\n    function CountryOrdersMapComponent(ecMapService, theme) {\n        var _this = this;\n        this.ecMapService = ecMapService;\n        this.theme = theme;\n        this.select = new core_1.EventEmitter();\n        this.layers = [];\n        this.alive = true;\n        this.options = {\n            zoom: 2,\n            minZoom: 2,\n            maxZoom: 6,\n            zoomControl: false,\n            center: L.latLng({ lat: 38.991709, lng: -76.886109 }),\n            maxBounds: new L.LatLngBounds(new L.LatLng(-89.98155760646617, -180), new L.LatLng(89.99346179538875, 180)),\n            maxBoundsViscosity: 1.0\n        };\n        rxjs_1.combineLatest([this.ecMapService.getCords(), this.theme.getJsTheme()])\n            .pipe(operators_1.takeWhile(function () { return _this.alive; }))\n            .subscribe(function (_a) {\n            var cords = _a[0], config = _a[1];\n            _this.currentTheme = config.variables.countryOrders;\n            _this.layers = [_this.createGeoJsonLayer(cords)];\n            _this.selectFeature(_this.findFeatureLayerByCountryId(_this.countryId));\n        });\n    }\n    CountryOrdersMapComponent.prototype.mapReady = function (map) {\n        map.addControl(L.control.zoom({ position: 'bottomright' }));\n        // fix the map fully displaying, existing leaflet bag\n        setTimeout(function () {\n            map.invalidateSize();\n        }, 0);\n    };\n    CountryOrdersMapComponent.prototype.createGeoJsonLayer = function (cords) {\n        var _this = this;\n        return L.geoJSON(cords, {\n            style: function () { return ({\n                weight: _this.currentTheme.countryBorderWidth,\n                fillColor: _this.currentTheme.countryFillColor,\n                fillOpacity: 1,\n                color: _this.currentTheme.countryBorderColor,\n                opacity: 1\n            }); },\n            onEachFeature: function (f, l) {\n                _this.onEachFeature(f, l);\n            }\n        });\n    };\n    CountryOrdersMapComponent.prototype.onEachFeature = function (feature, layer) {\n        var _this = this;\n        layer.on({\n            mouseover: function (e) { return _this.highlightFeature(e.target); },\n            mouseout: function (e) { return _this.moveout(e.target); },\n            click: function (e) { return _this.selectFeature(e.target); }\n        });\n    };\n    CountryOrdersMapComponent.prototype.highlightFeature = function (featureLayer) {\n        if (featureLayer) {\n            featureLayer.setStyle({\n                weight: this.currentTheme.hoveredCountryBorderWidth,\n                fillColor: this.currentTheme.hoveredCountryFillColor,\n                color: this.currentTheme.hoveredCountryBorderColor\n            });\n            if (!L.Browser.ie && !L.Browser.opera12 && !L.Browser.edge) {\n                featureLayer.bringToFront();\n            }\n        }\n    };\n    CountryOrdersMapComponent.prototype.moveout = function (featureLayer) {\n        if (featureLayer !== this.selectedCountry) {\n            this.resetHighlight(featureLayer);\n            // When countries have common border we should highlight selected country once again\n            this.highlightFeature(this.selectedCountry);\n        }\n    };\n    CountryOrdersMapComponent.prototype.resetHighlight = function (featureLayer) {\n        if (featureLayer) {\n            var geoJsonLayer = this.layers[0];\n            geoJsonLayer.resetStyle(featureLayer);\n        }\n    };\n    CountryOrdersMapComponent.prototype.selectFeature = function (featureLayer) {\n        if (featureLayer !== this.selectedCountry) {\n            this.resetHighlight(this.selectedCountry);\n            this.highlightFeature(featureLayer);\n            this.selectedCountry = featureLayer;\n            this.select.emit(featureLayer.feature.properties.name);\n        }\n    };\n    CountryOrdersMapComponent.prototype.findFeatureLayerByCountryId = function (id) {\n        var layers = this.layers[0].getLayers();\n        var featureLayer = layers.find(function (item) {\n            return item.feature.id === id;\n        });\n        return featureLayer ? featureLayer : null;\n    };\n    CountryOrdersMapComponent.prototype.ngOnDestroy = function () {\n        this.alive = false;\n    };\n    var _a, _b, _c;\n    tslib_1.__decorate([\n        core_1.Input(),\n        tslib_1.__metadata(\"design:type\", String)\n    ], CountryOrdersMapComponent.prototype, \"countryId\", void 0);\n    tslib_1.__decorate([\n        core_1.Output(),\n        tslib_1.__metadata(\"design:type\", typeof (_a = typeof core_1.EventEmitter !== \"undefined\" && core_1.EventEmitter) === \"function\" ? _a : Object)\n    ], CountryOrdersMapComponent.prototype, \"select\", void 0);\n    CountryOrdersMapComponent = tslib_1.__decorate([\n        core_1.Component({\n            selector: 'ngx-country-orders-map',\n            styleUrls: ['./country-orders-map.component.scss'],\n            template: \"\\n    <div leaflet [leafletOptions]=\\\"options\\\" [leafletLayers]=\\\"layers\\\" (leafletMapReady)=\\\"mapReady($event)\\\"></div>\\n  \"\n        }),\n        tslib_1.__metadata(\"design:paramtypes\", [typeof (_b = typeof country_orders_map_service_1.CountryOrdersMapService !== \"undefined\" && country_orders_map_service_1.CountryOrdersMapService) === \"function\" ? _b : Object, typeof (_c = typeof theme_1.NbThemeService !== \"undefined\" && theme_1.NbThemeService) === \"function\" ? _c : Object])\n    ], CountryOrdersMapComponent);\n    return CountryOrdersMapComponent;\n}());\nexports.CountryOrdersMapComponent = CountryOrdersMapComponent;\n",{"version":3,"file":"/home/hungnn/Documents/angular/dashboard/src/main/webapp/app/ngx-admin/pages/e-commerce/country-orders/map/country-orders-map.component.ts","sourceRoot":"","sources":["/home/hungnn/Documents/angular/dashboard/node_modules/angular-router-loader/src/index.js!/home/hungnn/Documents/angular/dashboard/node_modules/tslint-loader/index.js!/home/hungnn/Documents/angular/dashboard/src/main/webapp/app/ngx-admin/pages/e-commerce/country-orders/map/country-orders-map.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Input, OnDestroy, Output } from '@angular/core';\n\nimport * as L from 'leaflet';\n\nimport { CountryOrdersMapService } from './country-orders-map.service';\nimport { NbThemeService } from '@nebular/theme';\nimport { combineLatest } from 'rxjs';\nimport { takeWhile } from 'rxjs/operators';\n\n@Component({\n    selector: 'ngx-country-orders-map',\n    styleUrls: ['./country-orders-map.component.scss'],\n    template: `\n    <div leaflet [leafletOptions]=\"options\" [leafletLayers]=\"layers\" (leafletMapReady)=\"mapReady($event)\"></div>\n  `\n})\nexport class CountryOrdersMapComponent implements OnDestroy {\n    @Input() countryId: string;\n\n    @Output() select: EventEmitter<any> = new EventEmitter();\n\n    layers = [];\n    currentTheme: any;\n    alive = true;\n    selectedCountry;\n\n    options = {\n        zoom: 2,\n        minZoom: 2,\n        maxZoom: 6,\n        zoomControl: false,\n        center: L.latLng({ lat: 38.991709, lng: -76.886109 }),\n        maxBounds: new L.LatLngBounds(new L.LatLng(-89.98155760646617, -180), new L.LatLng(89.99346179538875, 180)),\n        maxBoundsViscosity: 1.0\n    };\n\n    constructor(private ecMapService: CountryOrdersMapService, private theme: NbThemeService) {\n        combineLatest([this.ecMapService.getCords(), this.theme.getJsTheme()])\n            .pipe(takeWhile(() => this.alive))\n            .subscribe(([cords, config]: [any, any]) => {\n                this.currentTheme = config.variables.countryOrders;\n                this.layers = [this.createGeoJsonLayer(cords)];\n                this.selectFeature(this.findFeatureLayerByCountryId(this.countryId));\n            });\n    }\n\n    mapReady(map: L.Map) {\n        map.addControl(L.control.zoom({ position: 'bottomright' }));\n\n        // fix the map fully displaying, existing leaflet bag\n        setTimeout(() => {\n            map.invalidateSize();\n        }, 0);\n    }\n\n    private createGeoJsonLayer(cords) {\n        return L.geoJSON(cords as any, {\n            style: () => ({\n                weight: this.currentTheme.countryBorderWidth,\n                fillColor: this.currentTheme.countryFillColor,\n                fillOpacity: 1,\n                color: this.currentTheme.countryBorderColor,\n                opacity: 1\n            }),\n            onEachFeature: (f, l) => {\n                this.onEachFeature(f, l);\n            }\n        });\n    }\n\n    private onEachFeature(feature, layer) {\n        layer.on({\n            mouseover: e => this.highlightFeature(e.target),\n            mouseout: e => this.moveout(e.target),\n            click: e => this.selectFeature(e.target)\n        });\n    }\n\n    private highlightFeature(featureLayer) {\n        if (featureLayer) {\n            featureLayer.setStyle({\n                weight: this.currentTheme.hoveredCountryBorderWidth,\n                fillColor: this.currentTheme.hoveredCountryFillColor,\n                color: this.currentTheme.hoveredCountryBorderColor\n            });\n\n            if (!L.Browser.ie && !L.Browser.opera12 && !L.Browser.edge) {\n                featureLayer.bringToFront();\n            }\n        }\n    }\n\n    private moveout(featureLayer) {\n        if (featureLayer !== this.selectedCountry) {\n            this.resetHighlight(featureLayer);\n\n            // When countries have common border we should highlight selected country once again\n            this.highlightFeature(this.selectedCountry);\n        }\n    }\n\n    private resetHighlight(featureLayer) {\n        if (featureLayer) {\n            const geoJsonLayer = this.layers[0];\n\n            geoJsonLayer.resetStyle(featureLayer);\n        }\n    }\n\n    private selectFeature(featureLayer) {\n        if (featureLayer !== this.selectedCountry) {\n            this.resetHighlight(this.selectedCountry);\n            this.highlightFeature(featureLayer);\n            this.selectedCountry = featureLayer;\n            this.select.emit(featureLayer.feature.properties.name);\n        }\n    }\n\n    private findFeatureLayerByCountryId(id) {\n        const layers = this.layers[0].getLayers();\n        const featureLayer = layers.find(item => {\n            return item.feature.id === id;\n        });\n\n        return featureLayer ? featureLayer : null;\n    }\n\n    ngOnDestroy(): void {\n        this.alive = false;\n    }\n}\n"]}]}